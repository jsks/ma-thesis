---
title: Executive Constraints and Civil Conflict Onset
author: J.L.A. Krusell
date: "`r format(Sys.time(), '%Y-%m-%d')`"
bibliography: library.bib
csl: assets/american-political-science-association.csl
link-citations: true
documentclass: scrreprt
fontsize: 11pt
linestretch: 1.5
header-includes:
    - \usepackage{amsmath}
    - \usepackage{etoolbox}
    - \usepackage{lualatex-math}
    - \usepackage{unicode-math}
    - \appto\Shaded{\singlespacing}
    - \BeforeBeginEnvironment{align*}{\begin{singlespace}\vspace*{-\baselineskip}}
    - \AfterEndEnvironment{align*}{\end{singlespace}\noindent\ignorespaces}
    - \counterwithout{table}{chapter}
    - \counterwithout{figure}{chapter}
output:
    pdf_document:
        fig_caption: true
        keep_tex: true
        latex_engine: lualatex
        toc: true
        toc_depth: 2
        pandoc_args: ["--syntax-definition", "assets/stan.xml",
                      "--highlight-style", "kate"]
    html_document:
        smart: true
        toc: true
abstract: Lorem ipsum
---

[//]: # Setup R environment for entire doc
```{r include = F, results = "hide"}
library(corrplot)
library(dplyr)
library(extraDistr)
library(ggplot2)
library(gridExtra)
library(magrittr)
library(kableExtra)
library(knitr)
library(parallel)
library(precrec)
library(tidyr)

# Load last to ensure nothing overwrites our namespace
library(thesis.utils)

options(knitr.kable.NA = ".")
opts_chunk$set(echo = F, eval = T, warning = F, fig.width = 5,
               fig.height = 3)

```

# Introduction {-}

# Theoretical Overview {-}

## Institutions and Civil Conflict

This paper takes as a starting premise a definition of institutions as
being "systems of established and embedded social rules that structure
social interactions" [@Hodgson2006]. More informally, we can consider
them to be the "rules of the game", encompassing for example codified
laws, norms, and shared understandings, all of which can constrain or
enable behaviour by influencing the perceptions and preferences of
actors through incentives and deterrents.[^institutions] Furthermore,
over time, the habits formed from these systems create expectations of
stable patterns of behaviour thereby further shaping the interactions
between actors by reducing uncertainty [@North1990]. Although there is
a wide variety of institutions, the present focus will be on the type
of institutions which govern political behaviour.

[^institutions]: None of which is meant to imply that institutions
    stand external to actor perceptions and preferences as unchanging
    features. Rather, institutions are social constructs subject to
    changing normative values and able to be reinforced or undermined
    by behavioural feedback loops. This latter point is especially
    interesting within the context of civil conflict considering how
    the development of various institutions and conflict incidence can
    by jointly determined; however, it remains outside the scope of
    this paper.

This exposition is relevant to the study of civil conflict for both
motivation-based and opportunity-based explanatory accounts. To the
extent that the onset of civil conflict is a longer process featuring
waves of escalation and de-escalation rather than a single one-off
event [@Florea2012; @Sambanis2004b], institutions are a key influence
on the constitutive interactions between state and non-state
actors. For example, they can shift the opportunity costs of violence
altering the mobilization capacity of would be rebel
groups. Institutions can also determine the extent to which the state
is seen as accountable to and representative of the larger population,
thereby influencing the legitimacy of anti-government violence.  And,
their quality can shape the capacity of the state to suppress or
co-opt potential opposition. Although the preceding examples are far
from forming an exhaustive list, there are thus a number of different
ways in which institutions can enter into theoretical discussions
about civil conflict.

Unsurprisingly, insofar as the role of institutions has been examined
by previous literature the focus has largely been on the broader
notion of democracy, which at a minimum is a system regulating access
to political power through popular representation determined by free
and competitive elections [@Schumpeter1962]. Democracy serves as a
proxy for a number of normatively desirable institutions and has been
hypothesised to have a pacifying domestic effect according to two
predominant mechanisms. The first is centered on the concept of
relative deprivation, or inequalities in value expectations and value
capabilities, as a primary source of discontent that can motivate
collective violence [@Gurr1970]. [^gurr] Democracy is thought to
decrease the amount of political discontent by providing avenues for
free expression and adjudicating group conflicts through non-violent
institutional means --- for example, through the regular occurrence of
free and fair elections [@Hegre2014]. The second mechanism assumes
that violent conflict is costly and that there exists a bargained
solution preferable to fighting, assuming that actors are rational and
able to internalize the cost of violence [@Fearon1995]. One of the
reasons why a bargained solution may be impossible is the risk of
future shifts in the distribution of power. More specifically, a
future change in favor of the relative strength of one of the parties
can provide an incentive to later renege. This influences the present
degree to which concessions can be offered and parties are willing to
credibly commit [@Powell2006]. Within the domestic sphere, democracy
offers a possible solution by formalising the regular contest of power
with full enfranchisement, thereby providing a *de jure* guarantee for
the balance of power [@Origins2006], and should, likewise, decrease
the likelihood of civil conflict.

[^gurr]: Gurr explains value expectations as being that which we think
    we are entitled to and value capabilities as that which we think
    we are capable of attaining. As Gurr then states, relative
    deprivation is the perceived discrepancy between the two. The link
    to collective violence, however, is conditional on the discontent
    being politicized, by which it is meant that the source of the
    discrepancy is identified and a normative and utilitarian
    justification is given for violent action, before finally being
    actualized.  Quantitative studies tend to focus on the first
    stage, the propensity for political regimes to generate
    discontent, given the difficultly of measuring the variables that
    may affect politicisation and actualisation.

Despite the theoretical basis linking democracy to reduced risks for
civil conflict, the empirical results tend to be mixed. @Hegre2001,
for example, find that democracies are at a lower risk for civil
conflict; however, no more so than fully authoritarian
states. Instead, anocratic regimes in between democracy and
authoritarianism are considered to be the most prone. The explanatory
logic is that both democratic and fully authoritarian states tend to
be consolidated regimes. In the case of the former, this means the
presence of institutions conducive to conflict resolution such that
the opportunity for rebellion may be present, given the presence of
civil liberties conducive to organizing, but there is a notable lack
in motivation for collective violence. For the latter, authoritarian
regimes may produce a significant amount of political discontent;
however, the opportunity is lacking due to the state's capacity and
willingness to violently repress dissent. Anocratic regimes are by
their very nature transitory, partly open and partly repressive,
encouraging political discontent against the state without the
capacity to either accommodate or suppress opposition.

In contrast, studies emphasizing the importance of political and
economic opportunities for rebellion in understanding when and where
conflicts break out, such as @Fearon2003 and @Collier2009, find
democracy to be insignificant. According to their theoretical
expositions, democracy should be associated with higher levels of
political rights, respect for ethnic and religious minorities, and
less repression, thus being a proxy for the latent level of political
discontent against the state. However, the argument follows that even
if the number of political grievances vary across regime types, they
are still ubiquitous enough to be a poor explanation for why conflict
breaks out in only a relatively small subset of countries. Instead,
the determining factors for conflict onset are the structural
conditions conducive to rebellion.[^opportunities]

[^opportunities]: For Fearon and Laitin these structural conditions
    are related to the features which make rebellion militarily
    viable.  Specifically, there's a higher risk of conflict onset
    where state capacity is weak, principally understood in terms of
    state revenue and its impact on policing and counterinsurgency
    operations; large impoverished populations; and insurgents having
    a terrain advantage. Collier *et al* start from the premise that
    war is expensive and the primary impediment to a rebellion is its
    financial feasibility relative to the strength of the state. On
    the basis of their results they go so far as provide support to
    the proposition, "where a rebellion is financially and militarily
    feasible it will occur." Both approaches, however, reach the same
    conclusion concerning the empirical evidence surrounding the role
    of democracy.

To provide a more nuanced picture, an ongoing strain of research has
been dedicated to disaggregating measures of democracy into either
finer regime type categories or specific measures of individual
political institutions. The theories offered tend to follow a general
formula whereby formal lack or poor quality of some institution(s),
measured either directly or proxied by regime type, undermines the
capacity of the state to prevent armed insurgency and/or incentivises
opposition violence by restricting the opportunities for political
participation and increasing political discontent. For example,
@Carey2007 examines the executive selection process of Sub-Saharan
Africa and argues that executive elections, even when they are of poor
quality, reduce the risk of large-scale violent dissent. @Fjelde2010a
breaks down authoritarian regime types in Africa attributing the
significant variation in conflict risk to the differing institutional
configurations affecting a regime's ability to coerce or co-opt the
opposition. The conclusion is that previous indeterminate results
regarding the link between political institutions and conflict risk
may have been hamstrung by aggregate measures which poorly reflect the
within-group variation of political regimes. In a larger sample
including democratic polities, @Goldstone2010 create a regime
classification scheme based on measures for openness of executive
recruitment and competitiveness of political participation, as well as
factionalism in order to distinguish between partial democracies. They
offer a theory of civil conflict occurring in countries where elite
divisions undermine the capacity of the state to defeat an insurgency
and claim that a relatively parsimonious model including their regime
classification offers better predictive accuracy than previous
analyses and provides evidence that political institutions are a
dominant driving factor for both political instability and civil
conflict. Finally, @Bartusevic2018 construct a regime typology focused
specifically on electoral features, which are argued form the
essential core of the concept of democracy. Where there are
constraints on electoral contestation, the authors contend that such
constraints restrict the opportunities for non-violent political
participation thereby legitimising anti-government violence and
self-selecting recruits into rebel groups willing to engage in armed
conflict. Evidence is presented which the authors claim supports not
just the significance of regime type, but a negative monotonic
relationship between democracy and the risk of civil conflict.

Studies utilising individual measures beyond regime classification
have been largely focused on the concept of governance. For instance,
@Taydas2010 examine institutional quality as a means to capturing a
regime's governing capacity which is theorised to be linked to
conflict onset both in terms of political discontent --- a regime's
inability to govern effectively and respond to public needs leading to
grievances and a loss in legitimacy --- and political opportunities
for rebellion --- poor institutional quality undermines the state's
ability to handle a nascent, violent uprising. Specifically, they
assess corruption, rule of law, and bureaucratic quality and present
evidence that all three are negatively related to civil conflict
onset. Similarly, @Hegre2015a argue that the presence of formal
representative institutions does not fully capture the extent to which
a regime is capable of realizing policy goals benefiting the
public. Poor quality of government can therefore undermine the
legitimacy of a regime when citizens identify the state as responsible
for relative deprivation. In their empirical analysis, the authors
separate informal institutions related to good governance from formal
democratic institutions and find both important for reducing the
incidence of civil conflict, or in this specific case the recurrence
of conflict.

Taken together, this recent literature on civil conflict onset points
to the ongoing importance of political institutions. There remains,
however, significant work to be done identifying the causal mechanisms
and effects of specific institutions, especially in terms of further
disaggregating the concept of democracy beyond ever finer
classifications of regime type [@ari2016]. Furthermore, to the extent
that previous research has mostly focused on the effects of
institutions on would-be rebel motivation and/or political opportunity
structures, there is also a gap in terms of empirical analyses on how
institutions also shape the behaviour of the state in the lead up to a
civil conflict. Even in strictly economic explanations of civil
conflict where explanatory primacy is given to either greed-based
motivation or economic conditions conducive for rebellion, the state
is a key actor. How a state responds to dissent structures the
opportunity costs of violence as well as the salience of calls to
mobilization by rebel leaders. This latter point is especially
relevant in linking regime legitimacy to conflict since public
perception is shaped not simply by a regime's formal structure, but by
its conduct in repeated interactions with the public. To this end, it
is imperative to examine the types of institutions which exacerbate
the risk of conflict onset by enabling or constraining certain actions
by the state.

There are of course a large variety of political institutions whose
presence and quality can influence the behaviour of the state.  Given
the importance of the executive as a central authority, however,
especially in times of political crisis, institutions which affect the
executive's decision making should be pertinent. Chief among these is
the idea of executive constraints --- more formally, the institutional
constraints by other government bodies on the executive's ability to
abuse power and act unilaterally. Executive constraints can be
considered a subset of horizontal accountability and imply the
existence of state agents --- such as the legislature or the judiciary
--- with both the legal mandate and willingness to oversee or sanction
the executive thus serving as deterrents to the forms of
authoritarian excesses in executive power which may be linked to civil
conflict. [^ODonnell]

[^ODonnell]: Adapted from the definition of horizontal accountability
    offered by @ODonnell1998 who further argues that horizontal
    accountability can potentially be a distinguishing feature between
    consolidated democracies and newly democratic states, the latter
    of which may have free and open elections, but are considerably
    weaker in upholding liberal notions of individual freedom against
    state power and republican notions of representation. In this way,
    executive constraints can possibly aid in discriminating the types
    of partially democratized regimes which may be at a heightened
    risk for civil conflict.

The final motivation for examining executive constraints is that in
terms of previous research, the empirical evidence is
conflicted. @Getmansky2013, for example, offers a theory of executive
constraints playing a role in risk aversion in democratic polities;
however, they find their measure to be insignificant in predicting the
outbreak of insurgencies. On the other hand, @Fjelde2009 with a theory
tying executive constraints to public goods provisioning reports a
significant interaction term with public spending. Both cases use the
ordinal measure of executive constraints form Polity IV
[@Marshall2019]. This leaves open further work on additional
theoretical mechanisms and analyses using other datasets.

## Executive Constraints

There are three general pathways which can theoretically link the
concept of executive constraints to the onset of civil conflict:
executive looting and state weakness, credible commitments to
bargained solutions, and the impact of violent repression by the state
on rebel mobilization. In the case of the first, the absence of
effective constraints enables leaders to loot state resources
[@Blattman2017], diverting funds for the purposes of personal
rent-seeking and corruption, which can undermine the administrative
and military capacity of the state to combat a nascent
insurgency. Furthermore, such environments allow leaders to pay
selective benefits to close supporters at the expense of wider
redistributive policies. To the extent that the provisioning of public
goods may ameliorate grievances against the state and co-opt potential
opposition, a reduced risk for civil conflict could be expected where
there is a high level of redistributive public spending and the
presence of quality institutions able to check the ability of the
executive to engage in cronyism [@Fjelde2009]. Finally, the lack of
accountability stemming from missing executive constraints could make
the state an attractive prize to predatory rebel groups; however,
prior empirical evidence lends little credence to this mechanism
[@Bazzi2014].

The second pathway relates to the willingness of both the regime and
opposition to credibly commit to bargained solutions to avoid
conflict. For the opposition, the presence of government institutions
able to hold the executive to account with the threat, for example, of
investigations, sanctions, or court rulings reduces the uncertainty
over whether the current leader will later renege. From the
perspective of the regime, executive constraints serve to limit future
violent retributions if oppositional groups were to take power. This
latter point is especially salient in situations where a leader has
previously relied on violent repression to stay in power and fears
extralegal punishment. It should be noted, however, that in such
authoritarian settings the antecedent lack of effective executive
constraints does not explain why the leader decides to negotiate in
the first place. But, insofar as the bargained solution includes a
transition of power with democratic reforms, and possibly even
immunity for the current members of the regime, the inclusion of
future checks against the executive serves as a guarantee for the
current agreement thereby increasing the incentive to commit.

The final pathway involves the impact of executive constraints on
shaping the ability of rebel groups to recruit new members. In order
to mount an effective challenge to the state, rebel leaders need to be
able to mobilize fighters while avoiding defections. However,
participating in an armed rebellion is a costly endeavour. Non-elites
face both the immediate risk of fighting as well as the possibility of
future reprisals by the government. Furthermore, given that most civil
conflicts are protracted events against an often times much stronger
opponent the short-term utility from participation is relatively
low. Thus, rebel leaders must be able to offer proportionate selective
benefits to offset the associated costs of fighting
[@Mason1996]. [^rational] These benefits can include not only economic
payoffs, but also protection from government violence. When the
government engages in violent repression, especially in the form of
indiscriminate violence, the cost of non-participation is
raised. Rebel groups can provide local security guarantees against
government reprisals such that the opportunity cost of fighting is
lowered, thereby incentivizing participation [@Regan2005]. However,
this is predicated on the government lacking the capacity to fully
eradicate any rebel group. Where that capacity exists the state is
free to engage in reprisals.

[^rational]: TODO: Assuming rational actors...

It is at this point where the concept of executive constraints then
enters into the calculus. Leaders in nondemocratic states are more
likely to engage in violent repression as a response to internal
dissent [@Davenport2007a]. Executive constraints provide an
accountability mechanism deterring state violence by the leader
against their own citizens. Thus, where there are strong and effective
constraints on the executive, the opportunity cost for joining the
rebel side should be higher. Rebel leaders will then have to rely more
heavily on economic selective benefits [@Regan2005], creating a higher
barrier for mobilization and decreasing the risk of civil conflict
onset. It should be noted though, that where this relationship may not
hold is in situations of low intensity insurgencies involving
predatory rebel groups solely motivated by rent-seeking. The threshold
for mobilization in such scenarios is significantly lower than in full
scale civil wars, meaning that rebel groups can initiate a conflict
regardless of the current level of state repression.

Taken together, none of the aforementioned mechanisms are mutually
exclusive, and it is beyond the scope of the present paper to properly
adjudicate between them; however, they do converge on a single
testable proposition. Namely that higher levels of executive
constraints should be associated with a lowered risk of civil conflict
onset.  As discussed, this may be conditional though on the relative
capacity of the state --- if executive constraints affect the
mobilization potential for rebel groups, then in situations where the
government is willing to engage in repression and has the strength to
fully suppress the opposition, the impact of executive constraints on
civil conflict onset should be diminished. Furthermore, even if the
mobilization mechanism is not valid, the relationship could still be
confounded by the overall opportunity for rebellion --- the degree of
executive constraints may not be particularly relevant in relatively
stable countries with, for example, high levels of economic
development, little to no ethnic fractionalisation, and no easily
lootable resources to finance a rebellion. Regardless of
conditionalities, contrary results would indicate either that
executive constraints are indeterminate to the risk of civil conflict
or possibly that there is even a positive relationship since
constrained executives may be less able to effectively deal with
violent challenges due to risk aversion to violence and/or from the
slowdown of having to seek approval from a plurality of stakeholders
before committing to decisive action.

One final caveat, hitherto the relationship of executive constraints
to the notion of vertical accountability --- constraints on leaders by
free and open multiparty elections as well as an independent and
critical media --- has been left unspecified. This is not to diminish
the role of elections or the media; indeed, vertical accountability
can plausibly play a role in all of the mentioned mechanisms. For
example, studies on state repression have emphasised the importance of
non-elites in being able to vote elected offices out of office as an
effective deterrent against negative sanctioning by leaders
[@BuenoDeMesquita2005; @Davenport2007]. But elections occur only
intermittently and it is not an automatic given that voters will
punish an incumbent, especially when that repression is against an
oppressed minority community. Furthermore, while the media can expose
wrongdoing by government officials, legal punishment can only flow
through government bodies [@ODonnell1998]. Thus, executive constraints
are interesting in their own right.

# Empirics {-}

## Research Design

To examine the relationship between civil conflict onset and executive
constraints, I construct a dataset of relevant variables and run a
bayesian structural equation model with a measurement portion estimating
executive constraints as a latent construct and a multilevel logistic
regression relating the latent construct to the observed outcome,
civil conflict. The use of bayesian methods is particularly
advantageous in this setting since the constructed dataset is
comprised of the entire finite population of countries within a
non-random subset of years given only non-stochastic
missingness. Traditional frequentist estimators are inappropriate due
to the assumption that the observed data is drawn from a random,
repeatable generative mechanism. This is readily apparent when
attempting to interpret a frequentist confidence interval in the present
context. A standard confidence interval for a selected level of
significance, $\alpha$, reports only that $(1 - \alpha) 100 \%$ of the
calculated confidence intervals from additional inferences done on
repeated samples are expected to contain the true population value
[@Western1994]. However, for the current analysis the desired target
is really to be able to calculate directly the probability that the
current uncertainty interval contains the true value given the data
and the model specification. Bayesianism offers a solution by casting
probability as degrees of belief in some event wherein inference is
then the process of updating those prior beliefs in light of new
data. When using bayesian methods, parameters such as regression
coefficients are considered to be random, meaning that prior beliefs
in the form of probability distributions can be assigned and posterior
probability distributions estimated from observed data [@Western1999].

In what follows, I will first describe the regression portion of the
model before delving into the independent and dependent variables,
including the operationalizations and data sources as well as the
measurement model for executive constraints.[^model]

[^model]: The model code is written in Stan [@Carpenter2017] and was
    run with the `CmdStan` interface [@Team2019a] using four parallel
    chains at 2000 iterations each with a warmup of 1000. Convergence
    was assessed according to the potential scale reduction factor
    $\hat{R}$ and effective sample size (ESS) [@Vehtari2019] as well
    as standard Stan diagnostics. The full code is available in
    [Appendix A](#appendix-a) and a fully reproducible pipeline
    compromised of replication scripts is available at
    [https://github.com/jsks/ma-thesis](https://github.com/jsks/ma-thesis). A
    simulation analysis assessing the model and it's ability to
    recover simulated true values is available in [Appendix B](#appendix-b).


[//]: # Load merged dataset for descriptive stats in following sections

```{r results = "hide"}
merged.df <- readRDS("data/merged_data.rds")
```

### Regression Model

I model civil conflict onset as a multilevel regression where onset is
a function of a set of predictors, including executive constraints and
an array of control variables, together with several grouping factors
included as partially pooled varying intercepts. The units of analysis
are all independent country-years from 1951 until 2017, as determined
by data availability, with *I* countries indexed by $i = 1 \dotsc I$
and *T* years indexed by $t = 1 \dotsc T$. The dependent variable,
conflict onset, is a Bernoulli distributed binary variable where 1
denotes the onset of at least one new civil conflict in a given
country-year. The chosen link function transforming the linear
regression output into the probability of conflict onset, $\nu_{it}$,
is the inverse logistic such that $\nu_{it} \in [0, 1]$. [^invlogit]

[^invlogit]: Technically, the inverse logistic transforms values to
    the open interval, $(0, 1)$, but due to overflow/underflow in
    floating point calculations by computers the endpoints can be
    observed.

The full regression specification is then as follows:
\begin{align*}
  y_{it} & \sim \mathsf{Bernoulli}(\nu_{it}) \\
  \nu_{it} & = \mathsf{logit^{-1}}(\alpha + X_{it-1} \beta +
                 \sum_{k=1}^K \zeta^k_{j_{it}})
\end{align*}

where **X** is a vector of predictors, $\beta$ the vector of
regression slopes, and $\zeta^k$ the set of varying intercepts for *K*
grouping factors indexed by $j_k$. For the present analysis there are
only two grouping factors, year and country, to account for
cross-sectional unmodeled heterogeneity between countries and over
time [@Shor2007]. All predictors are also lagged by one year to
control for time endogeneity and standardized by substracting the mean
and dividing by the standard deviation for each variable to aid in
computation as well as comparison of the final $\beta$ estimates.

I place weakly informative priors on all parameters to allow the
posterior estimates to be largely determined by the observed data
while avoiding the more pathological values and hard constraints that
can arise from uninformative priors. For the slopes and population
intercept, given that the input data has been standardized, this
translates to:
\begin{align*}
    \alpha & \sim \mathsf{Normal}(0, 5) \\
    \beta & \sim \mathsf{Normal}(0, 2.5)
\end{align*}

For the varying intercepts modeling group-specific variability, I use
hierarchical priors to provide a regularizing effect against
overfitting [@Gelman2007].
\begin{align*}
    \zeta^k_j & \sim \mathsf{Normal}(0, \sigma^k) \\
    \sigma^k & \sim \mathsf{HalfCauchy}(0, 1)
\end{align*}

### Civil Conflict

The dependent variable, *civil conflict onset*, is taken from the
UCDP/PRIO Armed Conflict Dataset v19.1 [@Gleditsch2002;
@Pettersson2019] where intra-state conflict is defined as a violent
contest over a government or territory between a state and non-state
actor with a minimum threshold of 25 battle deaths within a single
country-year with a coverage from 1946 to 2018.  The data was merged
based on the government side for conflicts labeled as internal or
internationalized internal --- *i.e.* where *type_of_conflict* was
either 3 or 4. Multiple conflicts within the same years were
aggregated to form a binary variable coded as 1 to denote the onset of
at least one new civil conflict and 0 for all other years, including
years of ongoing conflict.[^conflict_type]

[^conflict_type]: Extrasystemic conflicts, *i.e.* imperial or colonial
    conflicts, were excluded largely due to lack of data. Ideally,
    such conflicts would be merged based on the territory location of
    the conflict, however, for colonies, for example, there is very
    little easily available economic data and it would be undesirable
    to use the data for the colonizing power due to the often wide
    discrepancies in development within colonial empires. TODO: maybe
    a blurb on theory?


The primary onset dates were determined according to UCDP/PRIO's
episodic definition where a new onset is coded for the same
incompatibility when there is at least a one year pause in the
fighting or drop below the battle death threshold. The primary
rationale is that civil conflicts often go through several distinct
phases of fighting which can make it difficult to accurately code the
end of a conflict. The episodic definition avoids potentially
conflating briefs lulls involving the same rebel groups and leaders
versus the re-emergence of previously long dormant
conflicts. Furthermore, in both scenarios, the theory linking
executive constraints to the incentives for political violence should
still hold.[^robust]

[^robust]: Due to the potential sensitivity of results to changing
    conflict definitions [@Sambanis2004b], all analyses were also run
    using only unique onsets as well as major episodic onsets with a
    threshold of 1000 battle deaths. The results are available in
    [Appendix C](#appendix-c).

In total there are `r sum(merged.df$episode_onset)` onsets in the
dataset according to the episodic definition affecting
`r filter(merged.df, episode_onset == 1) %$% n_distinct(country_name)`
unique countries out of a total of
`r n_distinct(merged.df$country_name)`. Figure \ref{fig:onsets} plots
the proportion of countries experiencing an ongoing civil conflict and
the proportion of countries experiencing new onsets of conflict over
time.

```{r fig.cap = "\\label{fig:onsets} Proportion of countries with ongoing civil conflicts and new onsets"}

df <- group_by(merged.df, year) %>%
    summarise(`New Onsets` = sum(episode_onset) / n(),
              `Ongoing Conflict` = sum(ongoing) / n()) %>%
    gather(variable, value, -year)

ggplot(df, aes(year, value, colour = variable)) +
    geom_line() +
    theme(legend.title = element_blank()) +
    ylab("Percentage of Countries") +
    xlab("Year")

```

### Measuring Executive Constraints

To measure executive constraints I use data from the Varieties of
Democracy (V-Dem) dataset v9.0 [@Coppedge2019]. V-Dem is a
cross-national time series dataset providing multidimensional,
disaggregated data on democracy and political institutions for over
200 countries with an overall year coverage from 1789 until 2018. The
principal data is drawn from expert coded surveys involving a global
network of over 3000 coders, most of whom are academics or
professionals working in policy related fields. Individual ratings are
aggregated into latent variable estimates using hierarchical ordinal
item response theory (IRT) models which take into account rater
reliability and varying rater thresholds
[@Pemstein2019]. [^thresholds] The result is over 220 lower level
indicators that are also combined through various aggregation
techniques to produce over 80 indices. Compared to datasets such as
Polity IV, which has traditionally been used in most analyses of civil
conflict, V-Dem provides much more fine grained, nuanced data, and
most importantly, includes measures of uncertainty propagated from the
IRT models. This latter point is crucial since ignoring measurement
error, especially in models with noisy data and small effect sizes as
is often the case in conflict studies, can bias estimates and lead to
overconfident results [@Treier2008; @Marquardt2019].


[^thresholds]: Thresholds relate to how the continuous latent trait
    for a given variable is mapped on to the ordinal answer categories
    presented on the survey. Due to differential item functioning,
    experts may perceive the magnitude of difference between answer
    items differently. For example, for the variable *v2elvotbuy*,
    election vote buying, experts may vary in how they interpret the
    difference between a 2 ("Restricted Vote Buying") and a 3 ("Almost
    No Vote Buying"). These two concepts, rater reliability and
    varying rater thresholds, correspond respectively to the
    *discrimination* and *difficulty* parameters in classical IRT
    models.

For the purposes of this paper I estimate an index measuring
executive constraints from a factor analysis of multiple manifest
variables drawn from the V-Dem dataset. The aim is to capture the
extent to which the executive is *de facto* constrained by other
government institutions --- more specifically, the legislature,
judiciary, and independent investigative bodies --- rather than the
*de jure* powers of any one institution *vis-à-vis* the executive, and
to do so using a latent variable aggregation that avoids the arbitrary
weighting of linear additive indices.[^additive] The aggregation
method is largely similar to the accountability index created by
@Luhrmann2017 and the presidentialism index created by @Sigman2018. By
creating a separate index, however, I am able to adjust the list of
included manifest variables as well as embed the factor analysis
within the larger regression model such that the uncertainty from the
latent factor propagates as a result of the estimation process.

[^additive]: A theoretical argument could be made that the oversight
    offered by each institution is a necessary condition and that any
    index should therefore be additive with equal weighting. However,
    this would be a normative measure capturing the degree to which a
    country-year fulfills an ideal concept, rather than measuring how
    constrained an executive actually is in practice.

For the legislature and the judiciary, the two principal government
branches most able to check the power of the executive, there needs to
be both a *capacity* and *willingness* for oversight. Thus, I include
the following legislative variables: *v2lgoppart*, opposition parties
able to exercise oversight; *v2lgfunds*, legislature controls its own
resources; *v2lginvstp*, legislature investigates in practice;
*v2lgqstexp*, legislature questions executive branch officials. For
the judicial component: *v2juhcind*, high court independence;
*v2juncind*, lower court independence; *v2juhccomp*, the degree to
which the government complies with high court decisions; *v2jucomp*,
the degree to which the government complies with lower court
decisions. And for the final dimension, independent investigative
bodies, I include the variable *v2lgotovst*, executive oversight by
bodies other than the legislature.

```{r fa-sum}
manifest <- merged.df %>%
    select(v2lgoppart, v2lgfunds, v2lginvstp, v2lgqstexp, v2juhcind,
           v2juncind, v2juhccomp, v2jucomp, v2lgotovst)

q <- summary_stats(manifest) %>%
    mutate(Variable = paste0("\\textit{", Variable, "}"))

kable(q, "latex", align = "c", booktabs = T, linesep = "", escape = F,
      caption = "Descriptive statistics for manifest variables") %>%
    kable_styling(latex_options = "striped")

```

Table \ref{tab:fa-sum} provides summary statistics for the manifest
variables. All of the variables are drawn from expert coded surveys
and have been aggregated by V-Dem using IRT models. Thus, they are all
on an unbounded scale with observations roughly falling between -3
and 3. Furthermore, the scale directions are identical and follow the
general direction of the survey answer categories for lower level
V-Dem indicators --- namely, low to high, *i.e.*, 0 is the "worst" and
the highest value the "best." For example, for $v2lginvstp$,
legislature investigates in practice, the answer category 0 denotes
that it is extremely unlikely that the legislature conducts an
investigation where the outcome would be unfavorable for the sitting
executive and the highest category, 4, denotes that it is certain or
nearly certain. As such, on the aggregated, unbounded scale, higher
values in the point estimates denote country-years where the
legislature is more likely to investigate. Finally, figure
\ref{fig:cor} also provides a correlation matrix demonstrating a
fairly high level of correlation across all variables indicating some
commonality in the covariation.

```{r fig.height = 5, fig.width = 7, fig.cap = "\\label{fig:cor} Correlation Heatmap"}
m <- cor(manifest, use = "pairwise.complete.obs") %>%
    signif(3)

corrplot(m, "number", "upper", diag = F, tl.col = "black")

```

Given the listed manifest variables, the estimation technique is then
as follows: for $m$ country-years indexed by $i = 1 \dotsc m$ and $n$
manifest variables indexed by $j = 1 \dotsc n$, let $Z \in
\mathbb{R}^{m \times n}$ be the matrix of manifest variables measured
with an observed degree of error, $Z^\ast \in \mathbb{R}^{m \times n}$
the matrix of unobserved true values, and $\theta$ the unidimensional
latent factor of length $m$ measuring executive constraints.

I first model the measurement error in the manifest variables by
assuming that the observed values are drawn from a normal distribution
where the location parameters are the unobserved true values and the
scale, $u$, the observed posterior standard deviations derived from
the IRT posterior distributions. [^err]
\[ Z_{ij} \sim \mathsf{Normal}(Z^\ast_{ij}, u_{ij}) \]

[^err]: An ideal approach would be to directly embed the individual
    IRT models aggregating the manifest variables into the larger
    executive constraints measurement model [@Marquardt2019]. However,
    this prohibitively increases the run time of the model.

The latent values for the manifest variables are then modeled as
functions of the latent factor $\theta$ with a standard factor
analytic mapping function.
\[ Z^\ast_{ij} \sim \mathsf{Normal}(\gamma_j + \lambda_j \theta_i, \psi_j) \]

In the preceding equation, $\lambda$ is the variable specific factor
loading, $\gamma$ the population intercepts, and $\psi$ the scale of
the error term. I assume local item independence such that the error
terms, $(\psi_1, \dotsc, \psi_n)$, are uncorrelated (cite Lord &
Novick). Furthermore, for the purposes of identifying the likelihood,
the scale of the latent factor, $\theta$, is fixed to mean $0$ and
standard deviation $1$ while the factor loadings, $(\lambda_1, \dotsc,
\lambda_n)$, are constrained to be positive [@Jackman2009]. The
positive constraints follow theory since, as stated previously, all of
the manifest variables exhibit the same scale direction and should be
positively correlated with the latent factor. Finally, similar to the
regression coefficients, I select the following weakly informative
priors:
\begin{align*}
    \gamma & \sim \mathsf{Normal}(0, 5) \\
    \lambda & \sim \mathsf{LogNormal}(0, 1) \\
    \psi & \sim \mathsf{Weibull}(2, 1)
\end{align*}

Finally, in the case of the legislative variables there is the added
issue of missing observations for country-years lacking a
legislature.[^missing] For those observations, given the centrality of
the legislature as a potential constraint against the executive, the
latent factor should ideally be lower conditional on the other
manifest variables. However, since the manifest variables are
themselves unbounded latent variables, minimal values cannot be
imputed without a nonlinear transformation to a bounded scale. I thus
take a cue from *v2x_horacc* and include into the model a dichotomized
version of *v2lgbicam*, how many chambers does the legislature
contain, denoted by the Bernoulli distributed variable, $w$, where
country-years with a sitting legislature are given a $1$ and
country-years where the legislature is missing or has been suspended,
$0$. The probability of a legislature being present, $\pi_i$, is then
a linear function of the latent factor, $\theta$, transformed by the
inverse logistic such that $\pi_i \in [0, 1]$. The practical effect is
that where there is data for the legislative manifest variables, the
latent factor is informed by the measured institutional quality of the
legislature. Where data is missing due to the suspension or lack of a
legislature, the latent factor is down weighted by the linear function
predicting $w$, conditional on the observed values of the remaining
manifest variables. The resulting model specification, including
priors, is as follows:
\begin{align*}
    w_i & \sim \mathsf{Bernoulli}(\pi_i) \\
    \pi_i & = \mathsf{logit}^{-1}(\eta + \delta \theta_i) \\
    \eta & \sim \mathsf{Normal}(0, 5) \\
    \delta & \sim \mathsf{LogNormal}(0, 1)
\end{align*}

[^missing]: Missingness due to the lack of of a particular
    institution, for example the suspension of high court, is an issue
    for the other manifest variables as well. However, only the
    existence of the legislature is coded by V-Dem as a separate
    variable. Furthermore, practically speaking, none of the other
    manifest variables exhibit the same systematic pattern of
    missingness in the dataset as the legislative variables. Whereas
    there are 1608 country-years lacking a legislature, or
    approximately $13.4\%$ of all post-1945 country-years, only 115
    are missing data for at least one of the judicial variables
    ($1\%$) and only 58 are missing for *v2exrescon* ($0.5\%$). The
    variable *v2lgotovst*, executive oversight by bodies other than
    the legislature, is an outlier with 1619 country-years missing
    ($13.5\%$ missingness) since there is an error in V-Dem's v9.0
    dataset whereby it has been cleaned according to when the
    legislature is missing. Thus, I impute *v2lgotovst* within the
    larger model where the legislature is missing by drawing missing
    values from a normal distribution with a mean and standard
    deviation estimated from the observed *v2lgotovst* data. No other
    country-years or variables are imputed. The rationale is that,
    disregarding data processing issues, missingness in V-Dem can
    arise either from a lack of expert coders or lack of
    information. The latter scenario will most likely be correlated
    with country-years where there is a crisis or significant
    political instability, such as coups or civil war, where extreme
    values are more probable. Since it cannot be assumed that the
    values are completely missing at random, the data generative
    process for missingness cannot be modeled without potentially
    introducing bias into the estimates.

### Additional Covariates

As mentioned during the theoretical discussion of possible mechanisms,
executive constraints alone are insufficient in determining the
outbreak of conflict. One possible mediator is the relative capacity
of the state. For the present analysis I follow @Fearon2003 in using
GDP per capita as a proxy for the state's administrative and military
capacity by roughly capturing the revenue potential available to the
state. This is far from being an ideal proxy for state capacity; GDP
per capita could also capture economic grievances as well as the
relative ease of financing a rebellion given low wages
[@Hendrix2010]. Data on GDP per capita, however, is significantly more
complete than other common competing measures such as bureaucratic
quality or tax revenue as a percent of GDP.[^wbgi] Furthermore, it is
more correlated with the administrative aspects of state capacity than
measures focused solely on military strength, such as military
expenditures [@Hendrix2010]. Thus, I use the natural log of the
*RGDP^o* variable, constant price real GDP, from Penn World Tables
(PWT) v9.1 (1950-2017) to allow for both cross-country and
cross-temporal comparisons of GDP per capita [@Feenstra2015] and
include an interaction term between GDP per capita and the latent
measure for executive constraints to capture the conditional
relationship.

[^wbgi]: For example, the World Bank governance indicator on
    government effectiveness extends back only until 1996 (TODO:
    cite). Given that measures of institutional quality often change
    fairly slowly, punctuated only by abrupt events such as coups or
    revolutions, an extended time series is desirable. Furthermore, in
    the specific case of bureaucratic quality, there is the added
    issue of endogeneity. An unconstrained executive may seek to
    promote government corruption and undermine both meritocratic
    recruitment into the bureaucracy as well as its impartiality.

In addition to state capacity, I also include a number of standard
variables drawn largely from previous literature. The list of
variables are not meant to provide an all encompassing theory of civil
conflict, but rather roughly capture the opportunity structures for
armed conflict.  This includes a single year lagged measure of GDP per
capita growth from PWT in order to capture short term economic shocks,
which may affect both the strength and legitimacy of the state
[@Bazzi2014]. I also include a measure of mean elevation from the
GROWup dataset [@Girardin2015] to capture terrain advantageous for
conducting an insurgency [@Fearon2003] as well as a measure of
population density derived from population data from PWT and the area
in square kilometers for each country from GROWup. Countries with a
higher population density may require a more extensive and competent
central administration and policing force in order to suppress violent
dissent [@Fearon2003]. There's also the possibility that a high
population density increases the competition for resources. If the
state is identified as the source of a particular scarcity, the risk
of civil conflict may increase. Similarly to GDP per capita, I also
transform mean elevation and population by the natural log. Finally, I
include measures of ethnic fractionalization in the form of the number
of political relevant ethnic groups and the percent of the population
facing discrimination. Where there are significant ethnic cleavages
and state sponsored discrimination, ethnic ties can facilitate
collective action thereby lowering the mobilization costs of rebel
groups [@Cederman2011].

To control for the time endogeneity of conflict --- past and current
civil conflicts can impact the present risk of conflict onset as well
as the current level of executive constraints --- I include a dummy
variable for ongoing conflict [^time] and the natural log of peace
years [^peace_yrs] [@Hegre2015a]. To account for spillover effects, I
include a dummy variable for whether a neighbouring country is
currently experiencing a civil conflict. One notable lack is a general
measure of political instability, which I omit since it could be
highly correlated with executive constraints and would potentially
bias results, at least for years of crisis where the risk of civil
conflict is highest. I do, however, include a dummy variable for the
independence year since newly sovereign states may be particularly
weak.

[^time]: To be more specific, civil conflicts can be highly
    destabilizing and severely affect the governing and military
    capacity of a state, increasing the risk for an additional
    conflict onset. Moreover, in times of particularly intense
    conflict, wartime powers may be granted to the executive bypassing
    normal institutional constraints. Thus, ongoing conflict is a
    potential confounder since it can influence both the probability
    of the outcome as well as the executive constraints
    measure.

[^peace_yrs]: The peace years variable is calculated as the number of
    years since the last conflict-year, including conflict-years from
    extrasystemic conflicts. For countries left censored due to the
    dataset starting date, I set the start of the peace year
    calculation to 1946, the end of World War II. The rationale is
    that World War II was a significant international event that
    reshaped the world order and even had domestic consequences for
    countries not directly involved. For newly independent countries,
    I use the independence date as the start year.

Table \ref{tab:reg-stats} lists the full descriptive statistics for
all regression covariates.

```{r reg-stats}
df <- merged.df %>%
    select(rgdpepc, rgdpepc_gro, pop_density, meanelev,
           rlvt_groups_count, neighbour_conflict, ongoing, peace_yrs,
           independence)

q <- summary_stats(df)

kable(q, "latex", align = "c", booktabs = T, linesep = "", escape = T,
      caption = "Descriptive statistics for regression covariates") %>%
    kable_styling(latex_options = "striped")

```

## Analysis

The analysis of the results is split into several sections. First, the
parameter estimates from the executive constraints measurement model
will be presented followed by the parameters pertaining to the
logistic regression and an assessment of model fit. The final section
will be a discussion linking the results back to the outlined theories
as well as an overview of the limitations of the presented model.

### Measurement Model

```{r  fig.cap = "\\label{fig:fpars} hello", warning = F}
load("./posteriors/full_model/input.RData")
fa <- read_post("./posteriors/full_model/fa_posteriors.csv.gz")

lg <- colnames(lg_mm$obs)
nonlg <- colnames(nonlg_mm$obs)

lambda <- extract(fa, pars = "lambda")
colnames(lambda) <- c(lg, nonlg)

psi <- extract(fa, pars = "psi")
colnames(psi) <- c(lg, nonlg)

gamma <- extract(fa, pars = "gamma")
colnames(gamma) <- c(lg, nonlg)

delta_eta <- extract(fa, pars = c("delta", "eta"))

p1 <- plot_pars(lambda)
p2 <- plot_pars(psi)
p3 <- plot_pars(gamma)
p4 <- plot_pars(delta_eta)

grid.arrange(p1, p2, p3, p4, ncol = 2, nrow = 2)
```

Table \ref{tab:fa} and figure \ref{fig:fpars} summarise the posterior
draws for the measurement model parameters according to $80$ percent
quantile intervals. According to the results, the factor loadings,
$\lambda$, for each manifest variable are fairly comparable, with the
exception of the lower value for *v2lgfunds* ("legislature controls
its own resources") and to a lesser extent *v2lgqstexp* ("legislature
questions executive branch officials in practice"). Relative to the
other manifest variables, both items are less informative in inferring
the values of the latent factor --- a $\lambda$ of zero would indicate
that the latent factor does not explain any of the variation in the
manifest variable. As for the variable specific intercepts, $\gamma$,
they are largely clustered around zero as to be expected given that
the manifest variables were standardized prior to the model run. Where
deviations do occur, most notably with several of the legislative
variables, it is because of the measurement error component of the
model shifting the mean for a specific variable away from zero. For
example, after adjusting for measurement error, the mean for
$v2lgfunds$ is on average slightly higher than the remaining manifest
variables, hence the negative intercept.

```{r fa, fig.height = 6, fig.width = 6, warning = F}
fa_pars <- extract(fa, c("lambda", "gamma", "psi", "delta", "eta")) %>%
    post_summarise(probs = c(0.10, 0.9)) %>%
    mutate(parameter = sub("\\[\\d+\\]", "", parameter) %>% sprintf("$\\%s$", .),
           interval = sprintf("[%.3f, %.3f]", signif(`10%`, 3), signif(`90%`, 3)),
           manifest = c(rep(c(lg, nonlg), 3),
                        rep("v2lgbicam", 2))) %>%
    select(-`10%`, -`90%`) %>%
    pivot_wider(id_cols = manifest, names_from = parameter, values_from = interval)

rownames(fa_pars) <- sprintf("\\textit{%s}", fa_pars$manifest)
fa_pars$manifest <- NULL

kable(fa_pars, "latex", align = "c", booktabs = T, linesep = "", escape = F,
      caption = "Posterior credible intervals for measurement model parameters") %>%
    kable_styling(latex_options = c("striped", "scale_down"), full_width = F,
                  protect_latex = F)
```

The $\delta$ and $\eta$ parameters correspond to the slope and
intercept in the linear predictor for the presence of a legislature,
*v2lgbicam*. The effect of their inclusion can be seen in figure
\ref{fig:bicam}. The latent factor, $\theta$, follows the
directionality of the manifest variables, greater values indicate a
more constrained executive and lower values vice versa. The density
plots indicate that on average, for country-years where there is no
legislature, *i.e.* $v2lgbicam$ is zero, the latent factor is lower,
although still conditional on the values for the remaining manifest
variables. Where the legislature is present, $\theta$ is distributed
according to the $Normal(0, 1)$ prior.

```{r fig.width = 3, fig.height = 2, fig.cap = "\\label{fig:bicam} Posterior density plots for $\\theta$"}
theta <- extract(fa, "theta")
plot_dens(theta, groups = lgbicam)

```

The final portion of the measurement model is the measurement error
adjustment. As described in the research design section, in order to
incorporate the posterior uncertainty from the V-Dem IRT aggregation,
the observed values for the manifest variables, $Z$, were assumed to
be drawn from normal distributions where the means were the unobserved
true values, $Z^{\ast}$, and the standard deviations the observed
posterior standard deviations as reported by V-Dem. The practical
effect is that where the reported error is larger, the uncertainty in
$Z^{\ast}$ estimates increases and the mean is drawn towards the
regression line in the factor analysis. In other words, the model is
more skeptical of outliers in the manifest variables. This posterior
shrinkage can be seen in figure \ref{fig:fa-line}. Figure
\ref{fig:err} meanwhile plots the range of the upper and low bounds of
the $80$ percent posterior quantile interval for an example manifest
variable in $Z^{\ast}$ against the V-Dem standard deviations as well
as the difference between the estimated posterior mean and the
observed mean.

```{r fig.cap = "\\label{fig:fa-line} Error"}
err <- read_post("posteriors/full_model/err_posteriors.csv.gz")

nonlg_est <- extract(err, "nonlg_est") %>%
    post_summarise %>%
    rename(codelow = `2.5%`, median = `50%`, codehigh = `97.5%`) %>%
    mutate(interval = codehigh - codelow,
           se = nonlg_mm$se[, 1],
           obs = nonlg_mm$obs[, 1],
           diff = obs - median)

idx <- sample(1:ncol(theta), 50)
theta_medians <- theta[, idx] %>% apply(2, median)

s <- seq(min(theta_medians) - 0.1, max(theta_medians) + 0.1, 0.01)

x <- data.frame(point = c(nonlg_est$obs[idx], nonlg_est$median[idx]),
                group = rep(1:length(idx), 2),
                factor = c(rep(1, length(idx)), rep(2, length(idx))) %>% as.factor,
                theta = rep(theta_medians, 2))

y <- data.frame(yhat = median(gamma[, 6]) + median(lambda[, 6]) * s,
                theta = s)

ggplot(x, aes(theta, point, group = group, col = factor)) +
    geom_line(alpha = 0.3) +
    geom_point(alpha = 0.8) +
    geom_line(data = y, aes(theta, yhat, group = NA, col = NA), alpha = 1)

```

```{r fig.cap = "\\label{fig:err} Errors"}
p1 <- ggplot(nonlg_est, aes(se, interval)) +
    geom_point(col = "#56B4E9", alpha = 0.2, shape = 1)

p2 <- ggplot(nonlg_est, aes(se, diff)) +
    geom_point(col = "#56B4E9", alpha = 0.2)

grid.arrange(p1, p2, ncol = 2)

```

#### Executive Constraints Estimates

In total there are `r nrow(final.df)` country-year estimates of
$\theta$, comprised of `r n_distinct(final.df$country_name)` unique
countries and scaled from approximately $-2$ to $2$.  Since not every
single country can be presented, figure \ref{fig:theta} provides a
time series plot for China, Brazil, Nigeria, Norway, and Russia so as
to provide an example of the actual $\theta$ estimates.  The countries
were chosen to represent a diversity of geographic regions as well as
political contexts. From the plot, China, being a single party
authoritarian state, is consistently ranked the worst in executive
constraints. The decline for Russia largely follows the ascent of
Vladimir Putin at the end of 1999 and his gradual consolidation of
power in the decades that followed. For both Nigeria and Brazil, the
measure captures periods of military dictatorship such as the period
following Johnson Aguiyi-Ironsi's seizure of power in Nigeria the 1966
coup d'etat. The last country, Norway, represents a consolidated
polyarchy for the time period under consideration with consistently
strong constraints against the executive office.

```{r fig.width = 7, fig.height = 5, fig.cap = "\\label{fig:theta} Theta"}
theta_summarised <- post_summarise(theta, probs = c(0.10, 0.5, 0.90)) %>%
    rename(codelow = `10%`, median = `50%`, codehigh = `90%`)

theta_summarised <- theta_summarised[final.df$reduced_idx, ] %>%
    mutate(country_name = final.df$country_name,
           year = final.df$year)

targets <- c("Brazil", "China", "Nigeria", "Russia", "Norway")

filter(theta_summarised, country_name %in% targets) %>%
    ggplot(aes(year, median, fill = country_name)) +
    geom_line() +
    geom_ribbon(aes(ymin = codelow, ymax = codehigh), alpha = 0.2)

```

```{r fig.cap = "\\label{fig:tie} Tie Fighter"}
targets <- c("Algeria", "Argentina", "Armenia", "Chile", "Colombia",
             "Egypt", "Georgia", "Ghana", "Hungary", "Indonesia",
             "Iran", "Israel", "Japan", "Kenya", "Mexico", "Poland",
             "Portugal", "Romania", "Rwanda", "Turkey", "Tunisia",
             "United States of America", "Zimbabwe")

df <- filter(theta_summarised, year %in% c(2017, 2007),
             country_name %in% targets) %>%
    mutate(year = as.factor(year),
           country_name = ifelse(country_name == "United States of America",
                                 "USA", country_name) %>%
               factor(levels = sort(c(targets, "USA"), T)))

ggplot(df, aes(median, country_name, colour = year)) +
    geom_point() +
    geom_errorbarh(aes(xmax = codehigh, xmin = codelow))

```

```{r results = "hide"}
romania_idx <- filter(final.df, country_name == "Romania", year %in% c(2007, 2017)) %$%
    reduced_idx

romania_p <- signif(mean(theta[, romania_idx[1]] > theta[, romania_idx[2]]) * 100, 2)

chile_idx <- filter(final.df, country_name == "Chile", year %in% c(2007, 2017)) %$%
    reduced_idx

chile_p <- signif(mean(theta[, chile_idx[1]] < theta[, chile_idx[2]]) * 100, 2)
```

To provide a further snapshot of a greater number of countries, figure
\ref{fig:tie} plots the $\theta$ estimates for 2017, the last year in
the dataset, compared to 2007 by country. A full list of all countries
is available in [Appendix C](#appendix-c). Note, the statistical
significance of differences between years for a single country cannot
strictly be judged by overlapping credible intervals
[@Schenker2001]. For example, Romania, despite having overlapping
credible intervals, still has a posterior probability of approximately
$`r romania_p`\%$ that the estimate for 2017 is lower than 2007. In
the case of Chile with even more visual overlap, there is a
$`r chile_p`\%$ posterior probability that the estimate for 2017 is
higher than 2007.


### Onset Regression

Figure \ref{fig:reg} plots the slope coefficients on the log-odds
scale from the logistic regression linking the latent construct for
executive constraints to the outcome, civil conflict onset. Credible
intervals are summarised the same as previous plots, 80 percent
quantile intervals, and exact values are reported in table
\ref{tab:reg}  together with the posterior probabilities that each
$\beta$ estimate is greater than zero and less than zero. Recall that
the dependent variables are standardized to have mean $0$ and standard
deviation $1$, with the exception of the ordinal/binary variables
Relevant Group Count, Neighbouring Conflict, Ongoing Conflict, and
Independence.

```{r reg, fig.height = 3, warning = F}
reg <- read_post("posteriors/full_model/reg_posteriors.csv.gz")

beta <- extract(reg, "beta")
colnames(beta) <- c("exec_constraints", colnames(X),
                    sprintf("exec * %s", colnames(X)[interaction_idx]))

# Probabilities that Beta < 0 and Beta > 0
probs <- apply(beta, 2, function(x) {
    list(below = mean(x < 0) %>% round(3) %>% sprintf("%.3f", .),
         above = mean(x > 0) %>% round(3) %>% sprintf("%.3f", .))
})

beta_s <- post_summarise(beta, probs = c(0.1, 0.9)) %>%
    mutate(`Interval Estimate` = sprintf("[%.3f, %.3f]",
                                         signif(`10%`, 3), signif(`90%`, 3)),
           `$Pr(\\beta < 0)$` = lapply(probs, `[[`, "below") %>% unlist,
           `$Pr(\\beta > 0)$` = lapply(probs, `[[`, "above") %>% unlist) %>%
    select(-`10%`, -`90%`, -parameter)

rownames(beta_s) <- colnames(beta) %>% gsub("_", "\\\\_", .)

kable(beta_s, "latex", align = c("c", "r", "r"), booktabs = T,
      linesep = "", escape = F,
      caption = "Posterior credible intervals for regression slopes") %>%
    kable_styling(latex_options = "striped", "scale_down")
```


```{r fig.cap = "\\label{fig:reg} hello world"}
plot_pars(beta)
```

For the $\beta$ parameter for executive constraints, this means that
there is an $80\%$ posterior probability that an increase of one
standard deviation decreases the log-odds of conflict onset between
$`r beta_s[1, 1]`$. A one standard deviation increase in this context
corresponds roughly to the difference between the level of executive
constraints for Zambia in 1967 under the administration of Kenneth
Kaunda right before the banning of opposition parties following the
1968 election with a score of approximately $0$ and Greece in 1976
shortly after the end of military rule and establishment of a
democratic republic and with a score of approximately $1$. The
probability that the $\beta$ estimate for executive constraints is
below $0$ is $0.984$.

```{r results = "hide"}
merged.df <- readRDS("data/merged_data.rds")

gdp_nigeria <- filter(merged.df, country_name == "Nigeria", year == 2014) %$%
    rgdpepc %>%
    prettyNum(big.mark = ",")

gdp_czech <- filter(merged.df, country_name == "Czech Republic", year == 1992) %$%
    rgdpepc %>%
    prettyNum(big.mark = ",")

gdpgro_korea <- filter(merged.df, country_name == "South Korea", year == 1990) %$%
    rgdpepc_gro %>%
    multiply_by(100) %>%
    signif(3)

gdpgro_usa <- filter(merged.df, country_name == "United States of America", year == 1992) %$%
    rgdpepc_gro %>%
    multiply_by(100) %>%
    signif(3)

lth <- filter(merged.df, country_name == "Lithuania", year == 2012) %>%
    select(pop, area_sqkm) %>%
    mutate(area_sqlm = signif(area_sqkm, 3))

india <- filter(merged.df, country_name == "India", year == 1978) %>%
    select(pop, area_sqkm, meanelev) %>%
    mutate(area_sqkm = signif(area_sqkm, 3),
           meanelev = signif(area_sqkm, 3))

afghan <- filter(merged.df, country_name == "Afghanistan", year == 2004) %>%
    select(meanelev) %>%
    mutate(meanelev = signif(meanelev, 3))

```

The slopes for the remaining covariates generally following the
intuitive expectation of their relationship to civil conflict onset
with high probabilities of being either greater than or less than
zero. For example, GDP per capita is negative to which a one unit
increase corresponds approximately to Nigeria in 2014 with a value of
$`r gdp_nigeria`$ and Czech Republic in 1992 after the fall of
communism with a value of $`r gdp_czech`$. In other words, an increase
in GDP per capita on the logarithmic scale decreases the log-odds of
conflict onset. Similarly, GDP per capita growth is negatively
associated with conflict onset with an increase from 0 to 1 on the
standardized scale matching the level of United States in 1992,
$`r gdpgro_usa`$ percent, and South Korea in 1990, $`r gdpgro_korea`$ percent.
Population density, mean elevation, number of politically relevant
ethnic groups, presence of neighbouring conflict, and the dummy
variable for independence year all increase the risk of civil conflict
onset. A one unit increase in population density is similar to going
from Lithuania in 2012 with a population of $`r lth$pop`$ million and
an area of $`r lth$area_sqkm`$ square kilometers to India in 1978 with
a population of $`r india$pop`$ million and an area of
$`r india$area_sqkm`$ square kilometers. A one unit increase for mean
elevation roughly matches the difference between India,
$`r india$meanelev`$ meters, and Afghanistan, $`r afghan$meanelev`$
meters. Finally, the number of peace years since the last civil
conflict and the dummy variable for ongoing civil conflict decrease
the risk of conflict onset. This latter result, though surprising, is
a result of conditioning on the other covariates.

```{r results = "hide"}
gdp_eth <- filter(merged.df, country_name == "Ethiopia", year == 2012) %$%
    rgdpepc %>%
    prettyNum(big.mark = ",")

gdp_india <- filter(merged.df, country_name == "India", year == 2014) %$%
    rgdpepc %>%
    prettyNum(big.mark = ",")

gdp_nz <- filter(merged.df, country_name == "New Zealand", year == 2002) %$%
    rgdpepc %>%
    prettyNum(big.mark = ",")
```

To interpret the results for the interaction term between the slopes
for executive constraints and GDP per Capita I calculate the marginal
effect of $\theta$, executive constraints, on the predicted
probability of civil conflict onset for different levels of GDP per
capita while holding constant the other covariates.  In this case, I
took the mean of GDP per capita growth, population density, mean
elevation, politically relevant ethnic group count, and peace years
while setting the dummy indicators for independence, ongoing conflict,
and neighbouring conflict and the random intercepts for year and
country to 0. The levels of GDP per capita were selected based on the
10\%, 50\%, and 90\% quantiles of the standardized log transformed
values. These levels roughly correspond to the GDP per capita of
Ethiopia in 2012 at $`r gdp_eth`$, India in 2014 at $`r gdp_india`$,
and New Zealand in 2002 at $`r gdp_nz`$. In the dataset there are $75$
conflict episode onsets below the first level, $198$ between the first
and second, $73$ between the second and third, and $6$ above the
third.

```{r fig.cap = "\\label{fig:int} Interaction between executive constraints and GDP per capita with 80\\% CIs"}
# Interaction plot
alpha <- extract(reg, "alpha")
theta_seq <- seq(-2.5, 2.5, .01)

state <- quantile(final.df$rgdpepc, probs = c(0.1, .5, 0.9))

f <- function(x, y) {
    with(final.df, alpha +
                   beta[, 1] * x +
                   beta[, 2] * y +
                   beta[, 3] * mean(rgdpepc_gro) +
                   beta[, 4] * mean(pop_density) +
                   beta[, 5] * mean(meanelev) +
                   beta[, 6] * mean(rlvt_groups_count) +
                   beta[, 7] * 0 +
                   beta[, 8] * 0 +
                   beta[, 9] * mean(peace_yrs) +
                   beta[, 10] * 0 +
                   beta[, 11] * x * y)
}


df <- lapply(state, function(y) {
    mclapply(theta_seq, function(theta) {
        p_hat <- boot::inv.logit(f(theta, y)) * 100
        post_summarise(p_hat, probs = c(0.1, 0.5, 0.9)) %>%
            mutate(theta = theta,
                   y = y)
    }, mc.cores = 4) %>% bind_rows
}) %>% bind_rows

df %<>%
    rename(codelow = `10%`,
           median = `50%`,
           codehigh = `90%`) %>%
    mutate(y = case_when(y == state[1] ~ "Low GDP per Capita",
                         y == state[2] ~ "Median GDP per Capita",
                         y == state[3] ~ "High GDP per Capita") %>%
               factor(levels = c("Low GDP per Capita",
                                 "Median GDP per Capita",
                                 "High GDP per Capita")))

ggplot(df, aes(theta, median)) +
    geom_line() +
    geom_ribbon(aes(ymin = codelow, ymax = codehigh), alpha = 0.2) +
    facet_grid(. ~ y) +
    xlab("Executive Constraints") +
    ylab("Predicted Probability")
```

From the results in figure \ref{fig:int} it is clear that the overall
effect of executive constraints when interacted with GDP per capita on
the predicted probability of conflict onset is negative. For countries
with a relatively high level of GDP per capita, going from the worst
to best in executive constraints decreases the predicted probability
of conflict onset from [1.5, 4.5] down to below 0.5. This effect
diminishes, however, for lower values of GDP per capita to the point
that executive constraints are practically indeterminate to the risk
of conflict onset for low-income country-years.

### Assessing Model Fit

Figure \ref{fig:phat} plots the densities of the first 50 posterior
draws for the predicted probabilities of conflict onset for two
groups, country-years that actually experienced an onset of a civil
conflict and country-years that did not. On average, the predicted
probabilities for the actual onset country-years are higher albeit
still extremely low. This can be seen in the summary statistics
reported in table \ref{tab:psum} for the posterior means of the
predicted probabilities. For onset country-years the interquartile
interval is only 0.0485 to 0.209 with a max of 0.556. To better
compare the predicted probabilities to the actual data, table
\ref{tab:confusion} presents a confusion matrix with a 0.2 cutoff,
which corresponds to the third quartile in the summary table.
`r signif((93 / (259 + 93)) * 100, 3)` percent of onsets and
`r signif((7902 / (7902 + 172)) * 100, 3)` percent of non-onsets are
correctly predicted. The false positive rate is
`r signif((172 / (7902 + 172)) * 100, 3)` percent and the false
negative rate is `r signif((259 / (93 + 259)) * 100, 3)` percent.

```{r fig.height = 2, fig.cap = "\\label{fig:phat} Density plot for predicted probabilities"}
p_hat <- extract(reg, "p_hat")

plot_dens(p_hat, groups = final.df$lepisode_onset) + xlim(c(0, 0.4))
```

```{r psum, warning = F}
p_mean <- colMeans(p_hat)

df <- bind_rows(summary(p_mean[final.df$lepisode_onset == 1]),
                summary(p_mean[final.df$lepisode_onset == 0])) %>%
    mutate_all(~signif(., 3))

rownames(df) <- c("Conflict Onset", "No Onset")

kable(df, "latex", align = "c", booktabs = T, linesep = "", escape = F,
      caption = "Summarized posterior predicted probabilities")
```

```{r confusion}
m <- table(p_mean > .2, final.df$lepisode_onset)

rownames(m) <- c("Predicted: No Onset", "Predicted: Onset")
colnames(m) <- c("Actual: No Onset", "Actual: Onset")

kable(m, "latex", align = "c", booktabs = T, linesep = "", escape = F,
      caption = "Confusion matrix with a 0.2 cutoff")
```


```{r results = "hide"}
x <- evalmod(scores = p_mean, labels = final.df$lepisode_onset)

auc <- attr(x$roc[[1]], "auc") %>% signif(3)
auc_pr <- attr(x$prcs[[1]], "auc") %>% signif(3)
```

Figure \ref{fig:roc} plots a receiver operating characteristic (ROC)
curve depicting the tradeoff between the true positive rate
(*sensitivity*) and the false positive rate --- $1 -
\mbox{specificity}$ where *specificity* refers to the true negative
rate --- for varying probability thresholds according to the posterior
means of the predicted probabilities. For example, for a threshold of
approximately 0.1, the model will correctly predict 50 percent of
onsets while misclassifying only 8 percent of non-onsets. The total
performance of the model can be summarized by the area under the curve
(AUC), which in this case is `r auc`.[^auc] However, for the present
analysis the results from the ROC curve are misleading since there is
a significant class imbalance in the dataset. Onsets comprise only 4
percent of all observations meaning that the false positive rate is
less sensitive to changing thresholds. Figure \ref{fig:roc} therefore
also plots a precision-recall (PRC) curve, which depicts the tradeoff
between *precision* --- the number of true positives divided by the
sum of the true positives and false positives --- and recall --- the
number of true positives divided by the sum of the true positives and
false negatives --- for varying thresholds. The advantage is that
*precision* is invariant to the number of non-onset years in the
dataset. From this plot it is clear that the precision of the model,
the ability to discriminate between onset country-years and false
predicted non-set country-years, drops drastically as the *recall* of
the model increases. The *AUC-PR* for this plot is only `r auc_pr`.
[^auc_pr]

[^auc]: An AUC of 1 for a ROC curve indicates that the model is able
    to perfectly predict the outcome while an AUC of 0.5 denotes the
    performance of a purely random classifier.

[^auc_pr]: Similar to the ROC curve, an ACU of 1 for a PRC curve
    denotes a perfect model. The AUC for the null model, or random
    classifier, is the proportion of actual positive outcomes to negative
    outcomes in the dataset. In this case this means approximately
    .042.


```{r fig.width = 7, fig.cap = "\\label{fig:roc} hello"}

autoplot(x, curvetype = c("ROC", "PRC"))
```

Taken together, the evidence suggests a fairly poor fit to the
underlying data. The confusion matrix demonstrates that even with a
relatively low cutoff, the model is still only able to accurately
predict 25 percent of conflict onsets. According to the ROC curve,
decreasing this threshold improves the true positive rate with a
relatively decent tradeoff in terms of the false positive rate, but as
stated, this is largely due to the imbalance in the outcome
variable. In terms of *precision*, the performance of the model
quickly degrades as the threshold decreases.

### Discussion

- Link back to original theory, confirmatory

- Small effect size
- Poor fit
- Noisy Data
- Robustness?
- Compared to democracy?

Further analyses?

# Conclusion {-}

# Appendices {-}

## A - Stan Code {#appendix-a}

```{stan, code = readLines("stan/model.stan"), eval = F, output.var = "x", echo = T}
```

\newpage

## B - Prior Simulation {#appendix-b}

In order

```{r eval = F}
prior_plot <- function(range, fn, title = NULL, ...) {
    data.frame(x = range) %>%
        ggplot(aes(x)) +
        stat_function(fun = fn, ...) +
        ggtitle(label = title) +
        theme(axis.title.y = element_blank(),
              axis.text.y = element_blank(),
              axis.ticks.y = element_blank())
}

p1 <- prior_plot(c(-20, 20), dnorm, args = list(mean = 0, sd = 5),
                 title = "Normal(0, 5)")
p2 <- prior_plot(c(-10, 10), dnorm, args = list(mean = 0, sd = 2.5),
                 title = "Normal(0, 2.5)")
p3 <- prior_plot(c(0, 5), dlnorm, args = list(meanlog = 0, sdlog = 0.5),
                 title = "Log-Normal(0, 0.5)")
p4 <- prior_plot(c(0, 3), dweibull, args = list(shape = 5, scale = 1),
                 title = "Weibull(5, 1)")
p5 <- prior_plot(c(0, 10), dhcauchy, args = list(sigma = 1),
                 title = "HalfCauchy(0, 1)")
p6 <- prior_plot(c(0, 1), dbeta, args = list(shape1 = 5, shape2 = 5),
                 title = "Beta(5, 5)")

grid.arrange(p1, p2, p3, p4, p5, p6, ncol = 2, nrow = 3)

```


```{r eval = F, warning = F}
load("posteriors/sim/simulated_summary.RData")

ggplot(pars.df, aes(parameter, point, color = type)) +
    geom_point() +
    geom_errorbar(aes(parameter, ymin = codelow, ymax = codehigh),
                  width = 0) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

```{r eval = F, warning = F}
latent.df <- arrange(latent.df, true_value) %>%
    mutate(idx = 1:n())

ggplot(latent.df, aes(idx, true_value)) +
    geom_point(col = "darkgrey") +
    geom_errorbar(aes(ymin = codelow, ymax = codehigh), alpha = 0.2, col = "darkblue") +
    ylab("True Value") +
    theme(axis.text.x = element_blank(),
          axis.title.x = element_blank(),
          axis.ticks.x = element_blank())

```

```{r eval = F, results = 'hide'}
x <- with(latent.df, mean(true_value <= codehigh & true_value >= codelow))
#x * 100

#plot(df$lg_se[, 1], df$lg[, 1] - colMeans(lg_est))
#plot(df$lg_se[, 1], lapply(lg_est, IQR) %>% unlist)

#which(df$lg[, 1] + 2 * df$lg_se[, 1] < colMeans(lg_est) |
#      df$lg[, 1] - 2 * df$lg_se[, 1] > colMeans(lg_est))

#v <- lapply(theta_old, IQR) %>% unlist
#plot(df$lg_se[, 1], v[df$obs_idx])

#plot(density(p), xlim = c(0, 1), ylim = c(0, 2))
#for (i in 1:100) lines(density(p_hat[i, ]), col = alpha("lightblue", 0.2))

#table(colMeans(p_hat) > .5, y)

```

\newpage


## C - Country Comparison {#appendix-c}

# References {-}

\singlespacing
